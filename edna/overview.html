<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>overview – Environmental DNA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f3c2ea88cadbcfb37ba28ffa2c97cfc1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-ae2d0dcda2edce4ab590422bb373b64f.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Environmental DNA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./overview.html" aria-current="page"> 
<span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workflow.html"> 
<span class="menu-text">Workflow</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./dada.html"> 
<span class="menu-text">DADA2</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">English</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./hun/index.html"> 
<span class="menu-text">Magyar</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#the-dna" id="toc-the-dna" class="nav-link active" data-scroll-target="#the-dna">The DNA</a></li>
  <li><a href="#mitochondrial-dna" id="toc-mitochondrial-dna" class="nav-link" data-scroll-target="#mitochondrial-dna">Mitochondrial DNA</a></li>
  <li><a href="#the-structure-of-dna" id="toc-the-structure-of-dna" class="nav-link" data-scroll-target="#the-structure-of-dna">The structure of DNA</a></li>
  <li><a href="#dna-in-the-environment" id="toc-dna-in-the-environment" class="nav-link" data-scroll-target="#dna-in-the-environment">DNA in the environment</a></li>
  <li><a href="#molecular-considerations-in-edna-analysis" id="toc-molecular-considerations-in-edna-analysis" class="nav-link" data-scroll-target="#molecular-considerations-in-edna-analysis">Molecular considerations in eDNA analysis</a></li>
  <li><a href="#persistence-and-interpretation" id="toc-persistence-and-interpretation" class="nav-link" data-scroll-target="#persistence-and-interpretation">Persistence and interpretation</a></li>
  <li><a href="#technologies-and-biotechnological-background" id="toc-technologies-and-biotechnological-background" class="nav-link" data-scroll-target="#technologies-and-biotechnological-background">Technologies and biotechnological background</a></li>
  <li><a href="#edna-timeline-overview" id="toc-edna-timeline-overview" class="nav-link" data-scroll-target="#edna-timeline-overview">eDNA timeline overview</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="the-dna" class="level2">
<h2 class="anchored" data-anchor-id="the-dna">The DNA</h2>
<p>In eukaryotes, genetic information is stored in <strong>DNA (deoxyribonucleic acid)</strong>. DNA is located in the cell nucleus and carries all the instructions required to build and operate a living organism. This information is encoded in the specific order of the four DNA bases (Adenine (A), Thymine (T), Guanine (G) and Cytosine (C)), which determines the genetic instructions for building proteins and functional RNA molecules.</p>
<p>Specific functional segments of DNA are called <strong>genes</strong>. A gene contains the blueprint for producing a particular protein or RNA. Between genes, there are also non-coding sequences, which can regulate gene expression or help maintain the structure of the DNA.</p>
<p>If the DNA from a single human cell were stretched out, it would be about 2 metres long, yet it is packed extremely tightly with histone proteins to fit into the cell nucleus, which is only 5–10 µm (0.005–0.01 mm) in diameter. DNA and histone proteins together form chromatin, which condenses even further during cell division to form the clearly visible <strong>chromosomes</strong>.</p>
<p>Human somatic cells contain 46 chromosomes arranged in 23 pairs – one chromosome of each pair is inherited from the mother, and the other from the father. All chromosomes together make up the <strong>genome</strong>, which represents the entire genetic material of an organism.</p>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="http://52.29.31.254/moonshotblog/wp-content/uploads/2018/04/from-cell-to-gene.jpg" class="img-fluid figure-img"></p>
<figcaption>The relationship between genes, DNA and chromosomes</figcaption>
</figure>
</div>
</div>
</section>
<section id="mitochondrial-dna" class="level2">
<h2 class="anchored" data-anchor-id="mitochondrial-dna">Mitochondrial DNA</h2>
<p>In addition to the DNA found in the cell nucleus, eukaryotic cells also contain mitochondrial DNA (mtDNA). Mitochondria are energy‑producing organelles that evolved from ancestral bacteria, and they retain their own small, circular genome.</p>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="https://ifg-ivf.com/cache/axa/content/122221.png" class="img-fluid figure-img"></p>
<figcaption>mtDNA</figcaption>
</figure>
</div>
</div>
<p>Key features of mtDNA:</p>
<ul>
<li><p>Much smaller than nuclear DNA (about 16,500 base pairs in humans).</p></li>
<li><p>Present in many identical copies per cell, because each cell contains multiple mitochondria.</p></li>
<li><p>Inherited maternally in most animals.</p></li>
<li><p>Contains protein‑coding genes, transfer RNA (tRNA) genes, and ribosomal RNA (rRNA) genes.</p></li>
</ul>
<section id="the-12s-rrna-gene-in-edna-studies" class="level3">
<h3 class="anchored" data-anchor-id="the-12s-rrna-gene-in-edna-studies">The 12S rRNA gene in eDNA studies</h3>
<p>One of the mitochondrial rRNA genes, the 12S ribosomal RNA (12S rRNA) gene, encodes part of the small subunit of the mitochondrial ribosome.</p>
<ul>
<li><em>Ribosomal RNA (rRNA) is an RNA molecule that forms the structural and functional core of ribosomes (cellular structures responsible for protein synthesis), enabling them to read mRNA and assemble amino acids into proteins.</em></li>
</ul>
<p>This gene is widely used as a marker in environmental DNA (eDNA) studies, especially for vertebrates, because:</p>
<ul>
<li><p>High copy number of mtDNA increases detection probability in degraded environmental samples.</p></li>
<li><p>Conserved regions allow for the design of universal primers that work across many species.</p>
<ul>
<li><em>Universal primers are short synthetic DNA sequences that bind to conserved regions of a target gene, allowing the same PCR reaction to amplify that gene from many different species. For example: <code>GTCGGTAAAACTCGTGCCAGC</code> (MiFish-U-F) and <code>CATGGTCTGATGTGACCTGAG</code> (MiFish-U-R) are universal primers for the 12S rRNA gene in vertebrates.</em></li>
</ul></li>
<li><p>Variable regions within the gene differ between species, enabling species‑level identification when the amplified DNA is sequenced.</p></li>
<li><p>Short target fragments (80–150 bp) are well‑suited to the typically degraded nature of eDNA.</p></li>
</ul>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="http://www.contexo.info/dna_basics/chromosomes/mitochondria/index_files/mitochondrial_dna.png" class="img-fluid figure-img"></p>
<figcaption>Human mitochondrial DNA showing the arrangement of regions that code for proteins and RNA molecules</figcaption>
</figure>
</div>
</div>
</section>
<section id="nuclear-vs-mitochondrial-dna" class="level3">
<h3 class="anchored" data-anchor-id="nuclear-vs-mitochondrial-dna">Nuclear vs mitochondrial DNA</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 44%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Nuclear DNA (nDNA)</th>
<th>Mitochondrial DNA (mtDNA)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Location</strong></td>
<td>Found in the cell nucleus</td>
<td>Found in the mitochondria</td>
</tr>
<tr class="even">
<td><strong>Structure</strong></td>
<td>Linear chromosomes</td>
<td>Circular molecule</td>
</tr>
<tr class="odd">
<td><strong>Number of copies</strong></td>
<td>Two copies per cell (diploid genome, one from each parent)</td>
<td>Hundreds to thousands of copies per cell</td>
</tr>
<tr class="even">
<td><strong>Size</strong></td>
<td>~3.2 billion base pairs in humans</td>
<td>~16,500 base pairs in humans</td>
</tr>
<tr class="odd">
<td><strong>Genes encoded</strong></td>
<td>~20,000–25,000 protein‑coding genes</td>
<td>37 genes (13 proteins, 22 tRNAs, 2 rRNAs)</td>
</tr>
<tr class="even">
<td><strong>Inheritance</strong></td>
<td>Biparental (from both mother and father)</td>
<td>Maternal only</td>
</tr>
<tr class="odd">
<td><strong>Function</strong></td>
<td>Encodes most of the proteins and regulatory elements</td>
<td>Encodes key components of oxidative phosphorylation</td>
</tr>
<tr class="even">
<td><strong>Mutation rate</strong></td>
<td>Relatively low (protected by histones and repair mechanisms)</td>
<td>Higher (exposed to reactive oxygen species in mitochondria)</td>
</tr>
<tr class="odd">
<td><strong>Use in research</strong></td>
<td>Genome‑wide studies, genetic disorders, evolutionary analyses</td>
<td>Tracing maternal lineages, species identification, phylogenetics</td>
</tr>
</tbody>
</table>
</section>
<section id="common-marker-genes-used-in-edna-studies" class="level3">
<h3 class="anchored" data-anchor-id="common-marker-genes-used-in-edna-studies">Common marker genes used in eDNA studies</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 37%">
<col style="width: 21%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th>Marker gene</th>
<th>Location in genome</th>
<th>Function</th>
<th>Typical amplicon length for eDNA</th>
<th>Main use cases in eDNA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>12S rRNA</strong></td>
<td>Mitochondrial DNA</td>
<td>Encodes part of the <strong>small subunit</strong> of the mitochondrial ribosome</td>
<td>80–150 bp (short fragments for degraded DNA)</td>
<td>Vertebrate metabarcoding (fish, amphibians, birds, mammals); high detection sensitivity due to high mtDNA copy number</td>
</tr>
<tr class="even">
<td><strong>16S rRNA</strong></td>
<td>Prokaryotic genomes (bacteria &amp; archaea) and mitochondrial DNA in eukaryotes</td>
<td>Encodes part of the <strong>large subunit</strong> of the ribosome (in mitochondria or prokaryotes)</td>
<td>100–500 bp (varies by study)</td>
<td>Microbial community profiling; some invertebrate and mitochondrial studies</td>
</tr>
<tr class="odd">
<td><strong>COI</strong></td>
<td>Mitochondrial DNA</td>
<td>Encodes subunit I of cytochrome c oxidase, part of the mitochondrial respiratory chain</td>
<td>~650 bp (full barcode), 150–300 bp (mini‑barcode for eDNA)</td>
<td>Standard animal DNA barcoding (BOLD, GenBank); species ID, especially invertebrates and fish</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-structure-of-dna" class="level2">
<h2 class="anchored" data-anchor-id="the-structure-of-dna">The structure of DNA</h2>
<p>DNA has a distinctive double helix structure, consisting of two complementary polynucleotide strands twisted around each other.</p>
<p>Each nucleotide, the basic unit of DNA, contains three components:</p>
<ul>
<li>A pentose sugar (<strong>deoxyribose</strong>, a five carbon sugar)</li>
<li>A phosphate group</li>
<li>A nitrogen containing base</li>
</ul>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="https://s3-us-west-2.amazonaws.com/courses-images/wp-content/uploads/sites/1094/2016/11/03164446/OSC_Microbio_10_02_Nucleotide.jpg" class="img-fluid figure-img"></p>
<figcaption>a) DNA nucleotide. b) The five carbons within deoxyribose are designated as 1ʹ, 2ʹ, 3ʹ, 4ʹ, and 5ʹ.</figcaption>
</figure>
</div>
</div>
<section id="polynucleotide-strand" class="level3">
<h3 class="anchored" data-anchor-id="polynucleotide-strand">Polynucleotide strand</h3>
<p>Nucleotides are joined together through a condensation reaction between the phosphate group of one nucleotide and the sugar of another. This reaction forms a <strong>phosphodiester bond</strong>, linking the 3′ carbon of one sugar to the phosphate on the 5′ carbon of the next nucleotide. The result is a continuous sugar–phosphate backbone.</p>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="https://s3-us-west-2.amazonaws.com/courses-images/wp-content/uploads/sites/1094/2016/11/03164452/OSC_Microbio_10_02_NAcidStrand.jpg" class="img-fluid figure-img"></p>
<figcaption>Sugar-phosphate backbone</figcaption>
</figure>
</div>
</div>
</section>
<section id="arrangement-in-the-double-helix" class="level3">
<h3 class="anchored" data-anchor-id="arrangement-in-the-double-helix">Arrangement in the double helix</h3>
<ul>
<li><p>Backbone location: the sugar–phosphate backbones run along the outside edges of the helix.</p></li>
<li><p>Base pairing: the nitrogenous bases project inward from the backbone and pair specifically with bases on the opposite strand:</p>
<ul>
<li>Adenine (A) pairs with Thymine (T) via two hydrogen bonds</li>
<li>Guanine (G) pairs with Cytosine (C) via three hydrogen bonds</li>
</ul></li>
</ul>
<p>These complementary base pairs hold the two strands together, maintaining the uniform shape of the double helix.</p>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="https://nci-media.cancer.gov/pdq/media/images/761781-571.jpg" class="img-fluid figure-img"></p>
<figcaption>Structure of DNA (Source: NIH)</figcaption>
</figure>
</div>
</div>
</section>
<section id="directionality-of-strands" class="level3">
<h3 class="anchored" data-anchor-id="directionality-of-strands">Directionality of strands</h3>
<p>The carbon atoms in deoxyribose are numbered 1′ to 5′:</p>
<ul>
<li>C1′ – bonds to the nitrogenous base</li>
<li>C3′ – has an –OH group that bonds to the phosphate of the next nucleotide</li>
<li>C4′ – part of the ring structure</li>
<li>C5′ is not in the ring — it sticks out from C4′ and is attached to the phosphate group</li>
</ul>
<p>One strand runs 5′ → 3′ (free phosphate at the 5′ end, free –OH at the 3′ end), while the complementary strand runs 3′ → 5′.</p>
<div class="container">
<div class="quarto-figure quarto-figure-center" style="max-width: 100%; height: auto;">
<figure class="figure">
<p><img src="https://s3-us-west-2.amazonaws.com/courses-images/wp-content/uploads/sites/1094/2016/11/03164502/OSC_Microbio_10_02_DoubHelix.jpg" class="img-fluid figure-img"></p>
<figcaption>a) The sugar-phosphate backbones are on the outside of the double helix and purines (A, G) and pyrimidines (C, T) form the “rungs” of the DNA helix ladder. b) The two DNA strands are antiparallel to each other. c) The direction of each strand is identified by numbering the carbons (1 through 5) in each sugar molecule.</figcaption>
</figure>
</div>
</div>
<p>Importance of the antiparallel arrangement</p>
<ul>
<li><p>Base pairing: stable hydrogen bonds form only when strands run in opposite directions, maintaining the uniform width of the helix.</p></li>
<li><p>Replication: DNA polymerase adds nucleotides only to the 3′ end of a growing strand.</p></li>
<li><p>Stability: opposite orientation and phosphate positioning reduce electrostatic repulsion, helping stabilise the helical structure.</p></li>
</ul>
</section>
</section>
<section id="dna-in-the-environment" class="level2">
<h2 class="anchored" data-anchor-id="dna-in-the-environment">DNA in the environment</h2>
<p>Once DNA leaves a cell, it becomes environmental DNA where it may be:</p>
<ul>
<li><p>Intracellular: still inside cells or organelles, offering more protection.</p></li>
<li><p>Extracellular: free-floating, bound to particles, or adsorbed onto sediment surfaces.</p></li>
<li><p>Adsorbed: bound to clays or organic matter, which can prolong persistence.</p></li>
</ul>
<p>Environmental DNA is highly vulnerable to degradation from:</p>
<ul>
<li><p>Microbial nucleases (enzymatic breakdown)</p></li>
<li><p>UV radiation (causing thymine dimers)</p></li>
<li><p>Temperature (higher = faster degradation)</p></li>
<li><p>pH extremes (acid/base hydrolysis)</p></li>
<li><p>Salinity (can stabilise temporarily but also cause precipitation)</p></li>
</ul>
<p>Typical fragment sizes in aquatic eDNA are &lt;200 bp due to degradation.</p>
<p><em>Environmental DNA is the total pool of DNA isolated from environmental samples. Genomic DNA is extracted directly from specimens</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Primer binding in fragmented eDNA">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Primer binding in fragmented eDNA
</div>
</div>
<div class="callout-body-container callout-body">
<p>Because mitochondrial DNA contains many identical copies of the target gene, even when it is broken into short fragments, some of those fragments will still include the primer binding sites.</p>
<p>Although mitochondrial DNA in the environment is highly fragmented, the large number of genome copies per cell and the random nature of DNA breakage mean that some fragments will still contain the exact sequence where the primers can bind.</p>
<p>By targeting short, conserved regions (typically 80–150 bp) and collecting enough sample material, the likelihood of capturing an intact target fragment is high enough for reliable amplification.</p>
</div>
</div>
</section>
<section id="molecular-considerations-in-edna-analysis" class="level2">
<h2 class="anchored" data-anchor-id="molecular-considerations-in-edna-analysis">Molecular considerations in eDNA analysis</h2>
<p>Inhibition:</p>
<ul>
<li>Humic acids, tannins, and metals can inhibit PCR or qPCR by binding polymerases or chelating Mg²⁺.</li>
</ul>
<p>Primer design:</p>
<ul>
<li><p>Shorter amplicons (80–150 bp), smaller target DNA fragments, perform better with degraded eDNA because environmental degradation breaks DNA into shorter pieces.</p></li>
<li><p>G and C content influences both the melting temperature (Tm) and amplification success.</p>
<ul>
<li>G and C bases are linked by three hydrogen bonds, compared with two for A and T, so higher GC content increases Tm and requires more heat for strand separation. High GC regions can form stable secondary structures that hinder primer binding or polymerase activity, while very low GC content can cause weak primer binding and non‑specific amplification. Primers with balanced GC content (~40–60 %) generally achieve more reliable results.</li>
</ul></li>
</ul>
<p>Extraction:</p>
<ul>
<li>Efficiency depends on lysis method and whether DNA is intracellular or adsorbed to particles.</li>
</ul>
</section>
<section id="persistence-and-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="persistence-and-interpretation">Persistence and interpretation</h2>
<ul>
<li><p>Persistence: can be hours to weeks in water, months or more in sediments.</p></li>
<li><p>Transport: water currents can move eDNA away from its source.</p></li>
<li><p>False positives: legacy DNA from dead organisms.</p></li>
<li><p>False negatives: rapid degradation or low shedding rates.</p></li>
</ul>
</section>
<section id="technologies-and-biotechnological-background" class="level2">
<h2 class="anchored" data-anchor-id="technologies-and-biotechnological-background">Technologies and biotechnological background</h2>
<p>Every step of eDNA analysis – from sampling to bioinformatic processing – is based on modern molecular biotechnological methods.</p>
<section id="sampling-and-dna-extraction" class="level3">
<h3 class="anchored" data-anchor-id="sampling-and-dna-extraction">Sampling and DNA extraction</h3>
<ul>
<li>DNA from water, sediment, or soil is obtained using lysis buffers, enzymatic cell disruption (e.g.&nbsp;proteinase K), and filtration – all of which are classical molecular biotechnology laboratory procedures.</li>
</ul>
</section>
<section id="dna-amplification-and-detection-methods" class="level3">
<h3 class="anchored" data-anchor-id="dna-amplification-and-detection-methods">DNA amplification and detection methods</h3>
<p>In eDNA analysis, the multiplication and detection of target DNA regions are typically performed using a range of polymerase chain reaction (PCR)-based techniques. The choice of genetic marker is critical—short mitochondrial gene fragments (such as the 12S rRNA gene) are often preferred due to their high copy number per cell, broad primer compatibility across taxa, and resistance to degradation in environmental samples.</p>
<p>eDNA detection approaches can be grouped into three main categories:</p>
<ul>
<li>Species-specific detection: This method focuses on detecting individual taxa using species-specific primers and is especially useful for tracking endangered, rare, or invasive species.
<ul>
<li>Common techniques:
<ul>
<li>Conventional PCR (cPCR): Amplicons are visualised via gel electrophoresis.</li>
<li>Quantitative real-time PCR (qPCR): Tracks amplification in real time using fluorescence.</li>
<li>Nested PCR (nPCR): A two-step process that enhances sensitivity and specificity by re-amplifying a fragment within a broader target region. Useful for detecting low-abundance or elusive species.</li>
<li>Digital Droplet PCR (ddPCR): Partitions the sample into thousands of individual reactions. Ideal for detecting rare species in complex environmental samples.</li>
</ul></li>
</ul></li>
<li>eDNA metabarcoding: Enables the simultaneous detection of multiple species from a single eDNA sample using universal primers targeting conserved gene regions (e.g.&nbsp;12S for vertebrates).</li>
<li>eDNA metagenomics: Metagenomics involves direct shotgun sequencing of all DNA in a sample—without amplification. This captures both coding and non-coding regions, offering a comprehensive view of genetic diversity and ecological function.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled" title="Understanding DNA barcoding vs. metabarcoding vs. metagenomics">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Understanding DNA barcoding vs.&nbsp;metabarcoding vs.&nbsp;metagenomics
</div>
</div>
<div class="callout-body-container callout-body">
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Feature</strong></th>
<th><strong>DNA Barcoding</strong></th>
<th><strong>DNA Metabarcoding</strong></th>
<th><strong>eDNA Metagenomics</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Target</strong></td>
<td>One species at a time</td>
<td>Many species at once</td>
<td>All DNA present in a sample (taxa and functional genes)</td>
</tr>
<tr class="even">
<td><strong>Sample type</strong></td>
<td>Individual tissue (e.g.&nbsp;fin, scale)</td>
<td>Environmental sample (e.g.&nbsp;water, soil)</td>
<td>Environmental sample (e.g.&nbsp;water, sediment, soil)</td>
</tr>
<tr class="odd">
<td><strong>Method</strong></td>
<td>Amplify barcode from one organism</td>
<td>Amplify barcode from mixed community DNA</td>
<td>No amplification; direct shotgun sequencing</td>
</tr>
<tr class="even">
<td><strong>Sequencing</strong></td>
<td>Sanger sequencing</td>
<td>High-throughput sequencing (e.g.&nbsp;MiSeq)</td>
<td>Shotgun high-throughput sequencing (e.g.&nbsp;Illumina NovaSeq)</td>
</tr>
<tr class="odd">
<td><strong>Use case</strong></td>
<td>Species identification, taxonomy</td>
<td>Community structure, biodiversity surveys</td>
<td>Functional diversity, food web analysis, microbial ecology</td>
</tr>
<tr class="even">
<td><strong>Complexity</strong></td>
<td>Low</td>
<td>Moderate (requires bioinformatics)</td>
<td>High (requires advanced sequencing and computational tools)</td>
</tr>
<tr class="odd">
<td><strong>Limitations</strong></td>
<td>One species per reaction</td>
<td>May miss rare taxa or biased by primer choice</td>
<td>Costly, computationally intensive, complex data output</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="nextgeneration-sequencing-ngs" class="level3">
<h3 class="anchored" data-anchor-id="nextgeneration-sequencing-ngs">Next‑generation sequencing (NGS)</h3>
<ul>
<li>Platforms such as Illumina or Ion Torrent sequence large numbers of short DNA fragments, enabling species identification and community structure analysis.</li>
</ul>
</section>
<section id="bioinformatic-processing" class="level3">
<h3 class="anchored" data-anchor-id="bioinformatic-processing">Bioinformatic processing</h3>
<ul>
<li>Raw sequence data are cleaned, error‑corrected, and taxonomically assigned using software tools (e.g.&nbsp;DADA2, QIIME2); this step connects laboratory molecular work with ecological interpretation.</li>
</ul>
<p>All in all eDNA methods allow the study of species and communities without capturing or directly observing them, minimising disturbance to habitats. They can be used for the early detection of invasive species, monitoring protected or rare species, and assessing the effectiveness of restoration projects.</p>
</section>
</section>
<section id="edna-timeline-overview" class="level2">
<h2 class="anchored" data-anchor-id="edna-timeline-overview">eDNA timeline overview</h2>
<div class="timeline">
<ul>
<li><strong>1987</strong>: Term “environmental DNA” introduced in microbiology (Ogram et <em>al.</em> 1987).<br>
</li>
<li><strong>1998</strong>: Plant DNA detected in soil — the beginning of macrobial eDNA research (Paget et <em>al.</em> 1998).<br>
</li>
<li><strong>2003</strong>: First metagenetic analysis of soil eDNA (Willerslev et <em>al.</em> 2003).<br>
</li>
<li><strong>2005</strong>: First macrobial eDNA detection in river water (Martellini et <em>al.</em> 2005).<br>
</li>
<li><strong>2008</strong>: eDNA used to detect invasive American bullfrog (Ficetola et <em>al.</em> 2008).<br>
</li>
<li><strong>2010</strong>: Metagenetic methods applied to environmental samples (Creer et <em>al.</em> 2010).<br>
</li>
<li><strong>2011</strong>:
<ul>
<li>First aquatic eDNA metabarcoding for riverine fish (Minamoto et <em>al.</em> 2011).<br>
</li>
<li>Invasive silver and bighead carp detected in North America (Jerde et <em>al.</em> 2011).<br>
</li>
<li>Detection of aquatic microorganisms (e.g.anadromous/catadromous species (Xu et al.&nbsp;2018). bacteria, viruses, fungi, parasites) (Minamoto et <em>al.</em> 2011).<br>
</li>
</ul></li>
<li><strong>2012</strong>:
<ul>
<li>First marine eDNA studies: fish richness (Thomsen et <em>al.</em> 2012), marine mammals (Foote et <em>al.</em> 2012).<br>
</li>
<li>Broader applications in conservation begin (Thomsen et <em>al.</em> 2012).<br>
</li>
<li>Confirmation of rare and endangered species (Minamoto et <em>al.</em> 2012).<br>
</li>
<li>Biomass estimation from eDNA begins (Takahara et <em>al.</em> 2012).<br>
</li>
</ul></li>
<li><strong>2013</strong>:
<ul>
<li>Detection of fish pathogens and invasive species (Takahara et <em>al.</em> 2013).<br>
</li>
<li>Amphibian and gastropod detection continues (Pilliod et <em>al.</em> 2013; Goldberg et <em>al.</em> 2013).<br>
</li>
</ul></li>
<li><strong>2014</strong>:
<ul>
<li>Reptile detection using eDNA (Piaggio et <em>al.</em> 2014).<br>
</li>
<li>Importance of reference databases in species ID (Rees et <em>al.</em> 2014).<br>
</li>
<li>Invasive species detection confirmed (Keskin, 2014).<br>
</li>
</ul></li>
<li><strong>2015</strong>:
<ul>
<li>Detection of cryptic and elusive taxa (Deiner et <em>al.</em> 2015; Fukumoto et <em>al.</em> 2015).<br>
</li>
<li>Amphibian detection continues (Biggs et <em>al.</em> 2015).<br>
</li>
<li>Further development of eDNA metabarcoding to estimate fish communities (Miya et <em>al.</em> 2015).</li>
</ul></li>
<li><strong>2016</strong>:
<ul>
<li>Horizontal and vertical species richness patterns explored (Olds et <em>al.</em> 2016).<br>
</li>
<li>Broader biodiversity monitoring expands (Evans et <em>al.</em> 2016).<br>
</li>
</ul></li>
<li><strong>2018</strong>:
<ul>
<li>Migration tracking of anadromous/catadromous species (Xu et <em>al.</em> 2018).<br>
</li>
<li>Crustacean detection with eDNA (Wu et <em>al.</em> 2018).<br>
</li>
</ul></li>
<li><strong>2019</strong>:
<ul>
<li>eDNA used for mammals, reptiles (Franklin et <em>al.</em> 2019; Evans et <em>al.</em> 2019).<br>
</li>
<li>MinION portable sequencing enters the field (Garlapati et <em>al.</em> 2019).<br>
</li>
</ul></li>
<li><strong>2020</strong>:
<ul>
<li>Wildlife spatiotemporal distribution analysis (Carraro et <em>al.</em> 2020).<br>
</li>
<li>Crustacean community studies (Troth et <em>al.</em> 2020).<br>
</li>
</ul></li>
<li><strong>2021</strong>:
<ul>
<li>Terrestrial and aquatic biodiversity assessment (Evans, 2019).<br>
</li>
<li>Habitat preference modeling (Xie et <em>al.</em> 2021).<br>
</li>
<li>Vertical/horizontal richness patterns (Canals et <em>al.</em> 2021; Wood et <em>al.</em> 2021).<br>
</li>
</ul></li>
<li><strong>2022</strong>:
<ul>
<li>Spawning ecology explored (Wu et <em>al.</em> 2022).<br>
</li>
<li>Reptile detection expands (Nishizawa et <em>al.</em> 2022).<br>
</li>
</ul></li>
<li><strong>2023</strong>:
<ul>
<li>Assessment of anthropogenic impacts and climate change (Curtis et <em>al.</em> 2023).<br>
</li>
<li>Invasive species prediction refined (Beridze et <em>al.</em> 2023).<br>
</li>
<li>Remote ecosystem exploration (Rishan et <em>al.</em> 2023).<br>
</li>
</ul></li>
<li><strong>2024</strong>:
<ul>
<li>Phytoplankton and bacterial community analysis in marine sediments (Sahu et <em>al.</em> 2024).<br>
</li>
<li>Ecosystem impact and pollution monitoring (Suzuki et <em>al.</em> 2024).<br>
</li>
</ul></li>
</ul>
</div>
<section id="timeline-of-edna-studies-in-riverineestuarine-ecosystems" class="level3">
<h3 class="anchored" data-anchor-id="timeline-of-edna-studies-in-riverineestuarine-ecosystems">Timeline of eDNA studies in riverine/estuarine ecosystems</h3>
<div class="timeline">
<ul>
<li><p><strong>2018</strong><br>
<strong>Objective:</strong> Monitor the seasonal distribution of the endangered Chinese sturgeon using eDNA<br>
<strong>Location:</strong> Middle and lower reaches of the Yangtze River, China<br>
<strong>Result:</strong> Sturgeon eDNA detected at 9 sites during spawning season and 14 sites post-spawning; stable detection in middle reaches, variable in lower reaches reflecting migration<br>
<strong>Conclusion:</strong> eDNA metabarcoding is a reliable tool for tracking seasonal migration of endangered fish in large river systems<br>
<strong>Citation:</strong> Xu et <em>al</em>. 2018</p></li>
<li><p><strong>2021</strong><br>
<strong>Objective:</strong> Estimate spatial and temporal variation in biodiversity using eDNA<br>
<strong>Location:</strong> Tweed, Tees, Esk estuaries, England<br>
<strong>Result:</strong> 93 fish, 2 amphibians, 51 birds, 51 mammals, 13 invertebrates detected<br>
<strong>Conclusion:</strong> eDNA is a widely applicable tool; protocols must be standardised<br>
<strong>Citation:</strong> Mariani et <em>al.</em> 2021</p></li>
<li><p><strong>2021</strong><br>
<strong>Objective:</strong> Evaluate the role of eDNA metabarcoding in monitoring biodiversity of intertidal habitats<br>
<strong>Location:</strong> Thames Estuary, UK<br>
<strong>Taxa detected:</strong> Multiple fish and macroinvertebrate taxa across spatial and temporal scales<br>
<strong>Conclusion:</strong> eDNA metabarcoding offers valuable ecological insights and complements traditional monitoring; highlighted the importance of fine-scale spatial sampling<br>
<strong>Citation:</strong> Hallam et <em>al.</em> 2021 (PhD Thesis, Queen Mary University of London)</p></li>
<li><p><strong>2022</strong><br>
<strong>Objective:</strong> Compare fish diversity via bottom trawling vs eDNA metabarcoding<br>
<strong>Location:</strong> Pearl River Estuary, South China Sea<br>
<strong>Result:</strong> 49 fish taxa detected<br>
<strong>Conclusion:</strong> Success of eDNA depends on the molecular workflow<br>
<strong>Citation:</strong> Ruan et <em>al.</em> 2022</p></li>
<li><p><strong>2022</strong><br>
<strong>Objective:</strong> Study seasonal changes and taxa responsible for assemblage patterns<br>
<strong>Location:</strong> Manly Lagoon, Australia<br>
<strong>Result:</strong> 14 eukaryotes, 23 fish taxa detected<br>
<strong>Conclusion:</strong> eDNA can track shifts in assemblages driven by environmental change<br>
<strong>Citation:</strong> DiBattista et <em>al.</em> 2022</p></li>
<li><p><strong>2022</strong><br>
<strong>Objective:</strong> Estimate fish diversity<br>
<strong>Location:</strong> Merbok Estuary, Malaysia<br>
<strong>Result:</strong> 178 fish species<br>
<strong>Conclusion:</strong> eDNA performance affected by water current, exogenous transport, primer selectivity, and database quality<br>
<strong>Citation:</strong> Zainal Abidin et <em>al.</em> 2022</p></li>
<li><p><strong>2023</strong><br>
<strong>Objective:</strong> Assess eDNA detection of endangered estuarine pipefish and habitat associations<br>
<strong>Location:</strong> Bushmans Estuary, South Africa<br>
<strong>Result:</strong> Positive eDNA detection rate<br>
<strong>Conclusion:</strong> eDNA offers strong detection; toolkit needed for endangered fish monitoring<br>
<strong>Citation:</strong> Nester et <em>al.</em> 2023</p></li>
<li><p><strong>2023</strong><br>
<strong>Objective:</strong> Document fish presence and composition<br>
<strong>Location:</strong> Mangroves, Philippines<br>
<strong>Result:</strong> 89 fish species detected<br>
<strong>Conclusion:</strong> Promising tool; limited by reference databases and field/lab constraints<br>
<strong>Citation:</strong> Naputo et <em>al.</em> 2024</p></li>
<li><p><strong>2023</strong><br>
<strong>Objective:</strong> Investigate fish diversity<br>
<strong>Location:</strong> Inhambane Bay, South African mangroves<br>
<strong>Result:</strong> 109 fish species<br>
<strong>Conclusion:</strong> eDNA outperformed visual survey methods<br>
<strong>Citation:</strong> Janna, 2023</p></li>
<li><p><strong>2023</strong><br>
<strong>Objective:</strong> Evaluate fish assemblage structure across habitat types<br>
<strong>Location:</strong> Qinglangang Mangrove Reserve, China<br>
<strong>Result:</strong> Mangrove (117 genera), Seagrass (112), Coral reef (102)<br>
<strong>Conclusion:</strong> eDNA is ideal for monitoring heterogeneity across habitats<br>
<strong>Citation:</strong> Qiu et <em>al.</em> 2023</p></li>
<li><p><strong>2023</strong><br>
<strong>Objective:</strong> Compare fish assemblage data from traditional methods and eDNA<br>
<strong>Location:</strong> Dee Estuary, UK<br>
<strong>Result:</strong> 17 fish species<br>
<strong>Conclusion:</strong> eDNA enhances existing fish monitoring methods<br>
<strong>Citation:</strong> Gibson et <em>al.</em> 2023</p></li>
<li><p><strong>2024</strong><br>
<strong>Objective:</strong> Explore trophic levels via microbiome, plankton, and fish eDNA<br>
<strong>Location:</strong> Mangrove ecosystems, Hainan Island, China<br>
<strong>Result:</strong> 3779 taxonomic groups<br>
<strong>Conclusion:</strong> eDNA enables multi-trophic-level exploration from one sample<br>
<strong>Citation:</strong> Meng et <em>al.</em> 2024</p></li>
<li><p><strong>2024</strong><br>
<strong>Objective:</strong> Review comprehensive use of eDNA metabarcoding for evaluating fish biodiversity in estuaries<br>
<strong>Approach:</strong> Synthesises evidence across diverse estuarine systems and methodologies<br>
<strong>Key insights:</strong> Highlights sedimentary eDNA persistence (months-to-years, or even longer in stable conditions); emphasides careful sample handling such as immediate filtration to prevent degradation<br>
<strong>Conclusion:</strong> Provides best-practice recommendations for eDNA sampling in dynamic estuarine contexts<br>
<strong>Citation:</strong> Alenzi et <em>al.</em> 2024</p></li>
</ul>
</div>
<style>
.timeline {
  border-left: 3px solid #ccc;
  padding-left: 1rem;
}
.timeline > * {
  margin-bottom: 0.5rem;
}
</style>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>